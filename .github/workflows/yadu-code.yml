name: Yadu Code

on:
  workflow_dispatch:
    inputs:
      run_tests:  { description: 'Run tests',  default: 'true' }
      run_static: { description: 'Run static checks', default: 'true' }

jobs:
  yadu:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    steps:
      - uses: actions/checkout@v4
      - name: Verify no bidi chars in workflows
        run: '! grep -P "[\x{200E}\x{200F}\x{202A}-\x{202E}]" -R .github/workflows'
      - uses: actions/setup-java@v4
        with: { distribution: temurin, java-version: '21' }

      - name: Static checks (:yadu)
        if: ${{ inputs.run_static == 'true' }}
        run: ./gradlew --console=plain :yadu:check || echo "[yadu] :yadu not found, skipping"

      - name: Tests (:yadu)
        if: ${{ inputs.run_tests == 'true' }}
        run: ./gradlew --console=plain :yadu:test || echo "[yadu] :yadu not found, skipping"
